'use strict';

describe('File Browse dialog controller', function () {
    var controller, scope, deferred, volume, enums, datastore, fileBrowseFactory, createVPGModel;

    beforeEach(module('zvmTest'));

    beforeEach(inject(function ($controller, $rootScope, $q, _enums_) {
            enums = _enums_;
            deferred = $q.defer();

            fileBrowseFactory = jasmine.createSpyObj('fileBrowseFactory', ['save', 'close', 'browseForVmdkFiles', 'browseForVmdkFilesVcd']);
            fileBrowseFactory.save = function () {

            };
            fileBrowseFactory.close = function () {

            };
            fileBrowseFactory.browseForVmdkFiles.and.returnValue({
                then: function (resolve) {
                    return resolve({Files: [], SubFolders: []});
                }
            });
            fileBrowseFactory.browseForVmdkFilesVcd.and.returnValue({
                then: function (resolve) {
                    return resolve({Files: [], SubFolders: []});
                }
            });

            scope = $rootScope.$new();
            volume = JSON.parse('{"SourceAddress":"[ZNest81Datastore]:GUI Local VRA/e07c7991-3b10-4804-b8d4-98c1c529c98b/vm-273/Evgeny-vm1/Evgeny-vm1.vmdk","TargetAddress":"ZNest81Datastore (73.7GB / 99.8GB Free)","Swap":false,"ProvisionedSizeInMB":40,"InternalVolumeManagementSettings":{"DiskLocationParams":{"VMUuids":{"Uuid":"56 4d 71 b1 81 54 7d ae-26 9b 4a 2e 44 69 77 ac","InstanceUuid":"52 1f f3 4f c9 0b 3b 72-86 6e c8 56 cb c8 00 43"},"UnitNumber":0,"ControllerNumber":0,"VolumeType":0},"Settings":{"IsSwap":false,"VolumeReplicationDestination":{"ExistingDisk":{"SpecificDisk":{"Datastore":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"VmdkMode":0},"SearchFlags":1}}}},"IsSourceThinProvisioned":false}');
            datastore = JSON.parse('{"Datastore":{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore (73.7GB / 99.8GB Free)"},"IsEnabled":true,"$$hashKey":"0GZ"}');
            createVPGModel = JSON.parse('{"initPromise":{"promise":{}},"data":{"potentialResrouce":{"Datastores":[{"Datastore":{"Id":{"InternalDatastoreName":"datastore-10","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"[ds_cluster]datastore1 (344MB / 0.50GB Free)"},"IsEnabled":true,"$$hashKey":"0DS"},{"Datastore":{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore (73.7GB / 99.8GB Free)"},"IsEnabled":true,"$$hashKey":"0DT"},{"Datastore":{"Id":{"InternalDatastoreName":"datastore-224","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"public (339GB / 799GB Free)"},"IsEnabled":true,"$$hashKey":"0DU"},{"Datastore":{"Id":null,"DatastoreClusterIdentifier":{"InternalName":"group-p219","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DisplayName":"ds_cluster"},"IsEnabled":true,"$$hashKey":"0DV"}],"Networks":[{"Id":{"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"},"InternalType":"Network","InternalName":"network-11"},"DisplayName":"VM Network"}],"DescendantHosts":[],"PotentialFolders":[{"Id":{"InternalFolderName":"group-v41","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DisplayName":"[Default]ZertoRecoveryFolder"},{"Id":{"InternalFolderName":"group-v217","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DisplayName":"Zerto_guy_5763e93b-423e-4f26-bcd6-5449ae89dc13"},{"Id":{"InternalFolderName":"group-v207","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DisplayName":"Zerto_liron_4680b0ab-28bb-497c-a459-1dedb0fc4bb3"},{"Id":{"InternalFolderName":"group-v294","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DisplayName":"Zerto_org_a2b851d1-9963-4799-b5a4-f91a075e3644"},{"Id":{"InternalFolderName":"group-v3","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DisplayName":"/"}],"AssociatedRawDevices":[{"Destination":{"Device":{"InternalDeviceName":"naa.6005076802818070000000000000018f","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInKb":104857600,"SizeInBytes":107374182400,"DeviceName":"/vmfs/devices/disks/naa.6005076802818070000000000000018f","DevicePath":"/vmfs/devices/disks/naa.6005076802818070000000000000018f","Mode":1},"DisplayName":"IBM iSCSI Disk (naa.6005076802818070000000000000018f) - virtual","IsEnabled":true},{"Destination":{"Device":{"InternalDeviceName":"naa.6005076802818070000000000000018f","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInKb":104857600,"SizeInBytes":107374182400,"DeviceName":"/vmfs/devices/disks/naa.6005076802818070000000000000018f","DevicePath":"/vmfs/devices/disks/naa.6005076802818070000000000000018f","Mode":2},"DisplayName":"IBM iSCSI Disk (naa.6005076802818070000000000000018f) - physical","IsEnabled":true},{"Destination":{"Device":{"InternalDeviceName":"naa.60003ff44dc75adcaf63f9d163e1b60a","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInKb":187392,"SizeInBytes":191889408,"DeviceName":" ","DevicePath":" ","Mode":1},"DisplayName":"MSFT iSCSI Disk (naa.60003ff44dc75adcaf63f9d163e1b60a) - virtual","IsEnabled":true},{"Destination":{"Device":{"InternalDeviceName":"naa.60003ff44dc75adcaf63f9d163e1b60a","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInKb":187392,"SizeInBytes":191889408,"DeviceName":" ","DevicePath":" ","Mode":2},"DisplayName":"MSFT iSCSI Disk (naa.60003ff44dc75adcaf63f9d163e1b60a) - physical","IsEnabled":true},{"Destination":{"Device":{"InternalDeviceName":"mpx.vmhba1:C0:T0:L0","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInKb":8388608,"SizeInBytes":8589934592,"DeviceName":"/vmfs/devices/disks/mpx.vmhba1:C0:T0:L0","DevicePath":"/vmfs/devices/disks/mpx.vmhba1:C0:T0:L0","Mode":1},"DisplayName":"Local VMware Disk (mpx.vmhba1:C0:T0:L0) - virtual","IsEnabled":true},{"Destination":{"Device":{"InternalDeviceName":"mpx.vmhba1:C0:T0:L0","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInKb":8388608,"SizeInBytes":8589934592,"DeviceName":"/vmfs/devices/disks/mpx.vmhba1:C0:T0:L0","DevicePath":"/vmfs/devices/disks/mpx.vmhba1:C0:T0:L0","Mode":2},"DisplayName":"Local VMware Disk (mpx.vmhba1:C0:T0:L0) - physical","IsEnabled":true}]},"potentialVms":[{"DisplayName":"Alex VM - testing recovery(2)","Id":{"InternalVmName":"vm-348","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":4232},{"DisplayName":"Alex VM","Id":{"InternalVmName":"vm-342","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":4232},{"DisplayName":"Alex VM","Id":{"InternalVmName":"vm-269","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":4320},{"DisplayName":"puptitz-test","Id":{"InternalVmName":"vm-114","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":1271},{"DisplayName":"kobi vm 1(1)(2)(1)(1) - testing recovery","Id":{"InternalVmName":"vm-297","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":222},{"DisplayName":"kobi vm 1(1)(2)","Id":{"InternalVmName":"vm-354","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":117},{"DisplayName":"puptitz-test - testing recovery","Id":{"InternalVmName":"vm-266","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":231},{"DisplayName":"liron vm2 - testing recovery","Id":{"InternalVmName":"vm-267","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":247},{"DisplayName":"Evgeny-vm1 - testing recovery","Id":{"InternalVmName":"vm-312","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":258},{"DisplayName":"puptitz-test - testing recovery","Id":{"InternalVmName":"vm-302","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":1271},{"DisplayName":"kobi vm 1(1)(2) - testing recovery","Id":{"InternalVmName":"vm-306","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":222},{"DisplayName":"Alex VM","Id":{"InternalVmName":"vm-344","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":4232},{"DisplayName":"kobi vm 1(1)(2)","Id":{"InternalVmName":"vm-221","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":222},{"DisplayName":"Alex VM - testing recovery","Id":{"InternalVmName":"vm-325","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":4337},{"DisplayName":"GUY-bigVM - testing recovery","Id":{"InternalVmName":"vm-268","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":731},{"DisplayName":"kobi vm 1(1)(2)(2)","Id":{"InternalVmName":"vm-279","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":222},{"DisplayName":"kobi vm 1(1)(2)(3)","Id":{"InternalVmName":"vm-280","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":222},{"DisplayName":"kobi vm 1(1)(1) - testing recovery","Id":{"InternalVmName":"vm-223","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":366},{"DisplayName":"Evgeny-vm1 - testing recovery(3)","Id":{"InternalVmName":"vm-331","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":718},{"DisplayName":"Yaniv Test VM","Id":{"InternalVmName":"vm-16","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":4314},{"DisplayName":"Alex VM - testing recovery(1)","Id":{"InternalVmName":"vm-327","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":4337},{"DisplayName":"vappvVm2","Id":{"InternalVmName":"vm-285","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":4350},{"DisplayName":"kobi vm 1(1)(2)(1)","Id":{"InternalVmName":"vm-278","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":222},{"DisplayName":"alex vapp vm 1","Id":{"InternalVmName":"vm-308","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":4350},{"DisplayName":"vappVm1","Id":{"InternalVmName":"vm-284","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":4350},{"DisplayName":"Evgeny-vm1 - testing recovery(3)","Id":{"InternalVmName":"vm-353","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":613},{"DisplayName":"kobi vm 1(1)(2)(4)","Id":{"InternalVmName":"vm-289","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":222},{"DisplayName":"Evgeny-vm1 - testing recovery(1)","Id":{"InternalVmName":"vm-323","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":718}],"initialSitesInfo":{"LocalVCDVapps":[],"TargetSites":[{"OwnersId":{"Id":{"OwnersGuid":"505575bb-4416-455c-a6ee-933ed1d78e2c"},"DisplayName":"Unconfigured site name (Local)","IsLocal":true},"SiteId":{"SiteGuid":"e0a8f43c-174c-4c18-9530-ca59666b88d5"},"IsConnected":true,"IsVCenterEnabled":true,"IsVCDEnabled":false,"$$hashKey":"0BE"}],"AllowSourceVcenter":true,"PotentialZertoOrganization":[{"Identifier":{"Guid":"00000000-0000-0000-0000-000000000000"},"OrganizationName":"No Organization","CrmIdentifier":"No Contact"}]},"priorityCollection":{"Low":0,"Medium":1,"High":2},"potenaialSiteTypes":[{"type":"VC","value":0,"$$hashKey":"0DI"}],"defaultJournalHistoryCollection":[{"label":"1 Hour","value":60,"$$hashKey":"0BM"},{"label":"2 Hours","value":120,"$$hashKey":"0BN"},{"label":"3 Hours","value":180,"$$hashKey":"0BO"},{"label":"4 Hours","value":240,"$$hashKey":"0BP"},{"label":"5 Hours","value":300,"$$hashKey":"0BQ"},{"label":"6 Hours","value":360,"$$hashKey":"0BR"},{"label":"7 Hours","value":420,"$$hashKey":"0BS"},{"label":"8 Hours","value":480,"$$hashKey":"0BT"},{"label":"9 Hours","value":540,"$$hashKey":"0BU"},{"label":"10 Hours","value":600,"$$hashKey":"0BV"},{"label":"11 Hours","value":660,"$$hashKey":"0BW"},{"label":"12 Hours","value":720,"$$hashKey":"0BX"},{"label":"13 Hours","value":780,"$$hashKey":"0BY"},{"label":"14 Hours","value":840,"$$hashKey":"0BZ"},{"label":"15 Hours","value":900,"$$hashKey":"0C0"},{"label":"16 Hours","value":960,"$$hashKey":"0C1"},{"label":"17 Hours","value":1020,"$$hashKey":"0C2"},{"label":"18 Hours","value":1080,"$$hashKey":"0C3"},{"label":"19 Hours","value":1140,"$$hashKey":"0C4"},{"label":"20 Hours","value":1200,"$$hashKey":"0C5"},{"label":"21 Hours","value":1260,"$$hashKey":"0C6"},{"label":"22 Hours","value":1320,"$$hashKey":"0C7"},{"label":"23 Hours","value":1380,"$$hashKey":"0C8"},{"label":"24 Hours","value":1440,"$$hashKey":"0C9"},{"label":"48 Hours","value":2880,"$$hashKey":"0CA"},{"label":"72 Hours","value":4320,"$$hashKey":"0CB"},{"label":"96 Hours","value":5760,"$$hashKey":"0CC"},{"label":"120 Hours","value":7200,"$$hashKey":"0CD"}],"defaultTestPeriodCollection":[{"label":"1 Month","value":43200,"$$hashKey":"0D6"},{"label":"3 Months","value":131040,"$$hashKey":"0D7"},{"label":"6 Months","value":262080,"$$hashKey":"0D8"},{"label":"9 Months","value":394560,"$$hashKey":"0D9"},{"label":"12 Months","value":525600,"$$hashKey":"0DA"},{"label":"None","value":0,"$$hashKey":"0DB"}],"priority":1,"RPOAlertOptions":{"from":0,"to":38,"step":1,"smooth":true},"RPOAlert":"9","protectionGroupId":null,"isReverse":false,"vms":[{"DisplayName":"Evgeny-vm1 - testing recovery(2)","Id":{"InternalVmName":"vm-352","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":613},{"DisplayName":"Evgeny-vm1 - testing recovery(2)","Id":{"InternalVmName":"vm-324","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":718},{"DisplayName":"Evgeny-vm1 - testing recovery(2)","Id":{"InternalVmName":"vm-346","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":613}],"targetSite":{"OwnersId":{"Id":{"OwnersGuid":"505575bb-4416-455c-a6ee-933ed1d78e2c"},"DisplayName":"Unconfigured site name (Local)","IsLocal":true},"SiteId":{"SiteGuid":"e0a8f43c-174c-4c18-9530-ca59666b88d5"},"IsConnected":true,"IsVCenterEnabled":true,"IsVCDEnabled":false},"targetSiteType":{"type":"VC","value":0},"targetHost":{"ComputeResource":{"BaseComputeResourceIdentifier":{"InternalName":"host-9","Type":0,"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"ResourcePoolIdentifier":null,"DisplayName":"172.20.200.2"},"IsSuitableForRecovery":true,"RecoveryImpossibleReason":null},"name":"sadf","description":"","defaultVpgSettings":{"Config":{"Name":"sadf","Configuration":{"Priority":1,"MinimalJournalLenghtInMinutes":240,"RPOThressholdInSeconds":300,"MaxTestIntervalInMinutes":262080,"WanCompression":true,"ScriptingSettings":{"PreRecoveryScript":{"Command":null,"Parameters":null,"TimeoutInSeconds":300},"PostRecoveryScript":{"Command":null,"Parameters":null,"TimeoutInSeconds":300}},"ManageJournalSettings":{"JournalDatastore":null,"JournalHardLimitPerVM":{"Type":0,"Limit":0},"JournalWarningThresholdPerVM":{"Type":0,"Limit":0}},"BootOrder":{"Groups":[{"BootGroupIdentifier":{"Guid":"00000000-0000-0000-0000-000000000000"},"Name":"Default","Settings":{"BootDelay":0,"WaitForTools":false,"ShutdownDelay":0},"Machines":[{"DisplayName":"Evgeny-vm1 - testing recovery(2)","Id":{"InternalVmName":"vm-352","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":613},{"DisplayName":"Evgeny-vm1 - testing recovery(2)","Id":{"InternalVmName":"vm-324","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":718},{"DisplayName":"Evgeny-vm1 - testing recovery(2)","Id":{"InternalVmName":"vm-346","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"SizeInMb":613}]}]},"ServiceProfile":null,"Backup":{"Target":{"SelectedTarget":null},"Scheduler":{"RunningTime":{"SchedulePeriodType":1,"RunningTimeOfDayInMinutes":0,"DayOfWeek":6},"Retry":{"ShouldRetryOnFailure":true,"RetryTimes":3,"RetryIntervalInMinutes":10},"Window":{"ShouldTerminateIfExceedsWindow":false,"WeeklyWindow":{"Days":[{"Hours":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]},{"Hours":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]},{"Hours":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]},{"Hours":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]},{"Hours":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]},{"Hours":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]},{"Hours":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]}]}}},"Scripting":{"PostScript":{"Command":"","Parameters":"","TimeoutInSeconds":0}},"DeleteBackup":{"RestorePointRange":1}},"IsBackupEnabled":false},"Defaults":{"TargetComputeResource":{"BaseComputeResourceIdentifier":{"InternalName":"host-9","Type":0,"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"ResourcePoolIdentifier":null,"DisplayName":"172.20.200.2"},"TargetDatastore":{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore (73.7GB / 99.8GB Free)"},"FailoverNetwork":null,"TestNetwork":null,"TargetFolder":null,"FailoverVCDVAppNetwork":null,"TestVCDVAppNetwork":null},"ProtectedVappSettings":null,"RecoveryVappSettings":null,"VirtualMachines":[{"InternalVirtualMachineId":{"InternalVmName":"vm-324","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"Name":"Evgeny-vm1 - testing recovery(2)","SourceHost":{"BaseComputeResourceIdentifier":{"InternalName":"host-9","Type":0,"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"ResourcePoolIdentifier":null,"DisplayName":"172.20.200.2"},"SourceDatastore":{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore"},"TargetHost":{"BaseComputeResourceIdentifier":{"InternalName":"host-9","Type":0,"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"ResourcePoolIdentifier":null,"DisplayName":"172.20.200.2"},"TargetDatastore":{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore (73.7GB / 99.8GB Free)"},"StorageUsageInfo":{"ProvisionedStorageSizeInMB":718,"UsedStorageSizeInMB":40,"RecoveryStorageSizeInMB":0},"Volumes":[{"SourceAddress":"[ZNest81Datastore]:GUI Local VRA/e07c7991-3b10-4804-b8d4-98c1c529c98b/vm-273/Evgeny-vm1/Evgeny-vm1.vmdk","TargetAddress":"ZNest81Datastore (73.7GB / 99.8GB Free)","Swap":false,"ProvisionedSizeInMB":40,"InternalVolumeManagementSettings":{"DiskLocationParams":{"VMUuids":{"Uuid":"56 4d 71 b1 81 54 7d ae-26 9b 4a 2e 44 69 77 ac","InstanceUuid":"52 1f f3 4f c9 0b 3b 72-86 6e c8 56 cb c8 00 43"},"UnitNumber":0,"ControllerNumber":0,"VolumeType":0},"Settings":{"VolumeReplicationDestination":{"Datastore":{"IsThin":false,"TargetDatastore":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}}}}}},"IsSourceThinProvisioned":false}],"NetworkInterfaces":[{"InternalIdentifier":{"Name":"Network adapter 1"},"SourceNetwork":{"VcenterNetwork":{"Id":{"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"},"InternalType":"Network","InternalName":"network-11"},"DisplayName":"VM Network"},"VCDNetwork":null},"FailoverSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"TestSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"IsIPConfigurationEnabled":false,"MacAddress":"00:50:56:bd:9d:24"}],"TargetFolder":null,"StorageProfile":null,"JournalHardLimit":{"Type":0,"Limit":0},"JournalWarningThreshold":{"Type":0,"Limit":0},"JournalDatastores":[{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore (73.7GB / 99.8GB Free)"}]},{"InternalVirtualMachineId":{"InternalVmName":"vm-346","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"Name":"Evgeny-vm1 - testing recovery(2)","SourceHost":{"BaseComputeResourceIdentifier":{"InternalName":"host-9","Type":0,"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"ResourcePoolIdentifier":null,"DisplayName":"172.20.200.2"},"SourceDatastore":{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore"},"TargetHost":{"BaseComputeResourceIdentifier":{"InternalName":"host-9","Type":0,"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"ResourcePoolIdentifier":null,"DisplayName":"172.20.200.2"},"TargetDatastore":{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore (73.7GB / 99.8GB Free)"},"StorageUsageInfo":{"ProvisionedStorageSizeInMB":613,"UsedStorageSizeInMB":149,"RecoveryStorageSizeInMB":0},"Volumes":[{"SourceAddress":"[ZNest81Datastore]:Evgeny-vm1 - testing recovery(2)_1/Evgeny-vm1.vmdk","TargetAddress":"ZNest81Datastore (73.7GB / 99.8GB Free)","Swap":false,"ProvisionedSizeInMB":40,"InternalVolumeManagementSettings":{"DiskLocationParams":{"VMUuids":{"Uuid":"56 4d bd 1c 2f 59 84 43-b1 13 17 96 ea b6 6a e8","InstanceUuid":"52 b1 ba 64 de 6f 6a 7c-5e 6c e6 76 5e ff b8 30"},"UnitNumber":0,"ControllerNumber":0,"VolumeType":0},"Settings":{"VolumeReplicationDestination":{"Datastore":{"IsThin":false,"TargetDatastore":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}}}}}},"IsSourceThinProvisioned":false}],"NetworkInterfaces":[{"InternalIdentifier":{"Name":"Network adapter 1"},"SourceNetwork":{"VcenterNetwork":{"Id":{"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"},"InternalType":"Network","InternalName":"network-11"},"DisplayName":"VM Network"},"VCDNetwork":null},"FailoverSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"TestSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"IsIPConfigurationEnabled":false,"MacAddress":"00:50:56:bd:9d:24"}],"TargetFolder":null,"StorageProfile":null,"JournalHardLimit":{"Type":0,"Limit":0},"JournalWarningThreshold":{"Type":0,"Limit":0},"JournalDatastores":[{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore (73.7GB / 99.8GB Free)"}]},{"InternalVirtualMachineId":{"InternalVmName":"vm-352","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"Name":"Evgeny-vm1 - testing recovery(2)","SourceHost":{"BaseComputeResourceIdentifier":{"InternalName":"host-9","Type":0,"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"ResourcePoolIdentifier":null,"DisplayName":"172.20.200.2"},"SourceDatastore":{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore"},"TargetHost":{"BaseComputeResourceIdentifier":{"InternalName":"host-9","Type":0,"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"ResourcePoolIdentifier":null,"DisplayName":"172.20.200.2"},"TargetDatastore":{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore (73.7GB / 99.8GB Free)"},"StorageUsageInfo":{"ProvisionedStorageSizeInMB":613,"UsedStorageSizeInMB":149,"RecoveryStorageSizeInMB":0},"Volumes":[{"SourceAddress":"[ZNest81Datastore]:Evgeny-vm1 - testing recovery(2)_2/Evgeny-vm1.vmdk","TargetAddress":"ZNest81Datastore (73.7GB / 99.8GB Free)","Swap":false,"ProvisionedSizeInMB":40,"InternalVolumeManagementSettings":{"DiskLocationParams":{"VMUuids":{"Uuid":"56 4d 46 53 d9 5f 28 c7-6a 60 19 66 6e d2 e6 a7","InstanceUuid":"52 df 64 4a b1 10 29 d1-8f 29 00 20 36 c1 7b 86"},"UnitNumber":0,"ControllerNumber":0,"VolumeType":0},"Settings":{"VolumeReplicationDestination":{"Datastore":{"IsThin":false,"TargetDatastore":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}}}}}},"IsSourceThinProvisioned":false}],"NetworkInterfaces":[{"InternalIdentifier":{"Name":"Network adapter 1"},"SourceNetwork":{"VcenterNetwork":{"Id":{"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"},"InternalType":"Network","InternalName":"network-11"},"DisplayName":"VM Network"},"VCDNetwork":null},"FailoverSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"TestSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"IsIPConfigurationEnabled":false,"MacAddress":"00:50:56:bd:9d:24"}],"TargetFolder":null,"StorageProfile":null,"JournalHardLimit":{"Type":0,"Limit":0},"JournalWarningThreshold":{"Type":0,"Limit":0},"JournalDatastores":[{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore (73.7GB / 99.8GB Free)"}]}],"OwnersId":{"OwnersGuid":"505575bb-4416-455c-a6ee-933ed1d78e2c"},"ZertoOrganizationIdentifier":{"Guid":"00000000-0000-0000-0000-000000000000"}},"TargetSiteInfo":{"OwnersId":{"Id":{"OwnersGuid":"505575bb-4416-455c-a6ee-933ed1d78e2c"},"DisplayName":"Unconfigured site name (Local)","IsLocal":true},"PotentialReplicationDestinations":[{"ComputeResource":{"BaseComputeResourceIdentifier":{"InternalName":"host-9","Type":0,"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"ResourcePoolIdentifier":null,"DisplayName":"172.20.200.2"},"IsSuitableForRecovery":true,"RecoveryImpossibleReason":null,"$$hashKey":"0DL"},{"ComputeResource":{"BaseComputeResourceIdentifier":{"InternalName":"host-9","Type":0,"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"ResourcePoolIdentifier":{"InternalName":"resgroup-271","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DisplayName":"RP:172.20.200.2 puptitz-rp"},"IsSuitableForRecovery":true,"RecoveryImpossibleReason":null,"$$hashKey":"0DM"}],"VCDVirtualDatacenters":[],"PotentialServiceProfiles":[],"IsConnected":true,"IsPrePostScriptsEnabled":true,"PotentialBackupTargets":[{"Identifier":{"Identifier":"00000000-0000-0000-0000-000000000000"},"DisplayName":"None","IsDefault":true,"IsCompressionEnabled":true}]},"ProtectionGroupId":null,"Entities":{"Source":0,"Target":0},"ConfigurationFlags":{"IsStorageProfileEnabled":false,"IsCompressionConfigurable":true,"IsVmFolderConfigurable":true,"IsBackupFeatureSupported":true},"PotentialZertoOrganization":[{"Identifier":{"Guid":"00000000-0000-0000-0000-000000000000"},"OrganizationName":"No Organization","CrmIdentifier":"No Contact"}],"IsEnableVmJournalDatastoreSelection":true},"useScripts":false,"selectedVCDVapp":null,"isUsingVappNetworkMapping":false,"targetOrgvDC":null,"backupTargetDetails":{},"totalProvisionedSpace":1944,"vmsNicsList":[{"InternalIdentifier":{"Name":"Network adapter 1"},"SourceNetwork":{"VcenterNetwork":{"Id":{"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"},"InternalType":"Network","InternalName":"network-11"},"DisplayName":"VM Network"},"VCDNetwork":null},"FailoverSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"TestSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"IsIPConfigurationEnabled":false,"MacAddress":"00:50:56:bd:9d:24","vmId":{"InternalVmName":"vm-324","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"primaryKey":"vm-32400:50:56:bd:9d:24","vmName":"Evgeny-vm1 - testing recovery(2)","ProtectedNetwork":"VM Network","FailoverNetwork":"No Settings","FailoverIp":"","TestNetwork":"No Settings","TestIP":""},{"InternalIdentifier":{"Name":"Network adapter 1"},"SourceNetwork":{"VcenterNetwork":{"Id":{"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"},"InternalType":"Network","InternalName":"network-11"},"DisplayName":"VM Network"},"VCDNetwork":null},"FailoverSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"TestSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"IsIPConfigurationEnabled":false,"MacAddress":"00:50:56:bd:9d:24","vmId":{"InternalVmName":"vm-346","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"primaryKey":"vm-34600:50:56:bd:9d:24","vmName":"Evgeny-vm1 - testing recovery(2)","ProtectedNetwork":"VM Network","FailoverNetwork":"No Settings","FailoverIp":"","TestNetwork":"No Settings","TestIP":""},{"InternalIdentifier":{"Name":"Network adapter 1"},"SourceNetwork":{"VcenterNetwork":{"Id":{"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"},"InternalType":"Network","InternalName":"network-11"},"DisplayName":"VM Network"},"VCDNetwork":null},"FailoverSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"TestSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"IsIPConfigurationEnabled":false,"MacAddress":"00:50:56:bd:9d:24","vmId":{"InternalVmName":"vm-352","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"primaryKey":"vm-35200:50:56:bd:9d:24","vmName":"Evgeny-vm1 - testing recovery(2)","ProtectedNetwork":"VM Network","FailoverNetwork":"No Settings","FailoverIp":"","TestNetwork":"No Settings","TestIP":""}],"isSlaCustom":true,"selectedZORG":null,"awsSelected":false,"storageVolumes":[{"Index":0,"VMName":"Evgeny-vm1 - testing recovery(2)","VM":{"InternalVirtualMachineId":{"InternalVmName":"vm-324","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"Name":"Evgeny-vm1 - testing recovery(2)","SourceHost":{"BaseComputeResourceIdentifier":{"InternalName":"host-9","Type":0,"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"ResourcePoolIdentifier":null,"DisplayName":"172.20.200.2"},"SourceDatastore":{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore"},"TargetHost":{"BaseComputeResourceIdentifier":{"InternalName":"host-9","Type":0,"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"ResourcePoolIdentifier":null,"DisplayName":"172.20.200.2"},"TargetDatastore":{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore (73.7GB / 99.8GB Free)"},"StorageUsageInfo":{"ProvisionedStorageSizeInMB":718,"UsedStorageSizeInMB":40,"RecoveryStorageSizeInMB":0},"Volumes":[{"SourceAddress":"[ZNest81Datastore]:GUI Local VRA/e07c7991-3b10-4804-b8d4-98c1c529c98b/vm-273/Evgeny-vm1/Evgeny-vm1.vmdk","TargetAddress":"ZNest81Datastore (73.7GB / 99.8GB Free)","Swap":false,"ProvisionedSizeInMB":40,"InternalVolumeManagementSettings":{"DiskLocationParams":{"VMUuids":{"Uuid":"56 4d 71 b1 81 54 7d ae-26 9b 4a 2e 44 69 77 ac","InstanceUuid":"52 1f f3 4f c9 0b 3b 72-86 6e c8 56 cb c8 00 43"},"UnitNumber":0,"ControllerNumber":0,"VolumeType":0},"Settings":{"VolumeReplicationDestination":{"Datastore":{"IsThin":false,"TargetDatastore":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}}}}}},"IsSourceThinProvisioned":false}],"NetworkInterfaces":[{"InternalIdentifier":{"Name":"Network adapter 1"},"SourceNetwork":{"VcenterNetwork":{"Id":{"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"},"InternalType":"Network","InternalName":"network-11"},"DisplayName":"VM Network"},"VCDNetwork":null},"FailoverSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"TestSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"IsIPConfigurationEnabled":false,"MacAddress":"00:50:56:bd:9d:24"}],"TargetFolder":null,"StorageProfile":null,"JournalHardLimit":{"Type":0,"Limit":0},"JournalWarningThreshold":{"Type":0,"Limit":0},"JournalDatastores":[{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore (73.7GB / 99.8GB Free)"}]},"Volume":{"SourceAddress":"[ZNest81Datastore]:GUI Local VRA/e07c7991-3b10-4804-b8d4-98c1c529c98b/vm-273/Evgeny-vm1/Evgeny-vm1.vmdk","TargetAddress":"ZNest81Datastore (73.7GB / 99.8GB Free)","Swap":false,"ProvisionedSizeInMB":40,"InternalVolumeManagementSettings":{"DiskLocationParams":{"VMUuids":{"Uuid":"56 4d 71 b1 81 54 7d ae-26 9b 4a 2e 44 69 77 ac","InstanceUuid":"52 1f f3 4f c9 0b 3b 72-86 6e c8 56 cb c8 00 43"},"UnitNumber":0,"ControllerNumber":0,"VolumeType":0},"Settings":{"VolumeReplicationDestination":{"Datastore":{"IsThin":false,"TargetDatastore":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}}}}}},"IsSourceThinProvisioned":false},"Thin":false},{"Index":1,"VMName":"Evgeny-vm1 - testing recovery(2)","VM":{"InternalVirtualMachineId":{"InternalVmName":"vm-346","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"Name":"Evgeny-vm1 - testing recovery(2)","SourceHost":{"BaseComputeResourceIdentifier":{"InternalName":"host-9","Type":0,"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"ResourcePoolIdentifier":null,"DisplayName":"172.20.200.2"},"SourceDatastore":{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore"},"TargetHost":{"BaseComputeResourceIdentifier":{"InternalName":"host-9","Type":0,"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"ResourcePoolIdentifier":null,"DisplayName":"172.20.200.2"},"TargetDatastore":{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore (73.7GB / 99.8GB Free)"},"StorageUsageInfo":{"ProvisionedStorageSizeInMB":613,"UsedStorageSizeInMB":149,"RecoveryStorageSizeInMB":0},"Volumes":[{"SourceAddress":"[ZNest81Datastore]:Evgeny-vm1 - testing recovery(2)_1/Evgeny-vm1.vmdk","TargetAddress":"ZNest81Datastore (73.7GB / 99.8GB Free)","Swap":false,"ProvisionedSizeInMB":40,"InternalVolumeManagementSettings":{"DiskLocationParams":{"VMUuids":{"Uuid":"56 4d bd 1c 2f 59 84 43-b1 13 17 96 ea b6 6a e8","InstanceUuid":"52 b1 ba 64 de 6f 6a 7c-5e 6c e6 76 5e ff b8 30"},"UnitNumber":0,"ControllerNumber":0,"VolumeType":0},"Settings":{"VolumeReplicationDestination":{"Datastore":{"IsThin":false,"TargetDatastore":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}}}}}},"IsSourceThinProvisioned":false}],"NetworkInterfaces":[{"InternalIdentifier":{"Name":"Network adapter 1"},"SourceNetwork":{"VcenterNetwork":{"Id":{"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"},"InternalType":"Network","InternalName":"network-11"},"DisplayName":"VM Network"},"VCDNetwork":null},"FailoverSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"TestSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"IsIPConfigurationEnabled":false,"MacAddress":"00:50:56:bd:9d:24"}],"TargetFolder":null,"StorageProfile":null,"JournalHardLimit":{"Type":0,"Limit":0},"JournalWarningThreshold":{"Type":0,"Limit":0},"JournalDatastores":[{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore (73.7GB / 99.8GB Free)"}]},"Volume":{"SourceAddress":"[ZNest81Datastore]:Evgeny-vm1 - testing recovery(2)_1/Evgeny-vm1.vmdk","TargetAddress":"ZNest81Datastore (73.7GB / 99.8GB Free)","Swap":false,"ProvisionedSizeInMB":40,"InternalVolumeManagementSettings":{"DiskLocationParams":{"VMUuids":{"Uuid":"56 4d bd 1c 2f 59 84 43-b1 13 17 96 ea b6 6a e8","InstanceUuid":"52 b1 ba 64 de 6f 6a 7c-5e 6c e6 76 5e ff b8 30"},"UnitNumber":0,"ControllerNumber":0,"VolumeType":0},"Settings":{"VolumeReplicationDestination":{"Datastore":{"IsThin":false,"TargetDatastore":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}}}}}},"IsSourceThinProvisioned":false},"Thin":false},{"Index":2,"VMName":"Evgeny-vm1 - testing recovery(2)","VM":{"InternalVirtualMachineId":{"InternalVmName":"vm-352","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"Name":"Evgeny-vm1 - testing recovery(2)","SourceHost":{"BaseComputeResourceIdentifier":{"InternalName":"host-9","Type":0,"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"ResourcePoolIdentifier":null,"DisplayName":"172.20.200.2"},"SourceDatastore":{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore"},"TargetHost":{"BaseComputeResourceIdentifier":{"InternalName":"host-9","Type":0,"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"ResourcePoolIdentifier":null,"DisplayName":"172.20.200.2"},"TargetDatastore":{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore (73.7GB / 99.8GB Free)"},"StorageUsageInfo":{"ProvisionedStorageSizeInMB":613,"UsedStorageSizeInMB":149,"RecoveryStorageSizeInMB":0},"Volumes":[{"SourceAddress":"[ZNest81Datastore]:Evgeny-vm1 - testing recovery(2)_2/Evgeny-vm1.vmdk","TargetAddress":"ZNest81Datastore (73.7GB / 99.8GB Free)","Swap":false,"ProvisionedSizeInMB":40,"InternalVolumeManagementSettings":{"DiskLocationParams":{"VMUuids":{"Uuid":"56 4d 46 53 d9 5f 28 c7-6a 60 19 66 6e d2 e6 a7","InstanceUuid":"52 df 64 4a b1 10 29 d1-8f 29 00 20 36 c1 7b 86"},"UnitNumber":0,"ControllerNumber":0,"VolumeType":0},"Settings":{"VolumeReplicationDestination":{"Datastore":{"IsThin":false,"TargetDatastore":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}}}}}},"IsSourceThinProvisioned":false}],"NetworkInterfaces":[{"InternalIdentifier":{"Name":"Network adapter 1"},"SourceNetwork":{"VcenterNetwork":{"Id":{"ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"},"InternalType":"Network","InternalName":"network-11"},"DisplayName":"VM Network"},"VCDNetwork":null},"FailoverSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"TestSettings":{"VCenterNetworkSettings":{"RecoveryNetwork":null,"IP":null,"DnsSuffix":null,"ShouldReplaceMacAddress":false},"VCDNetworkSettings":null},"IsIPConfigurationEnabled":false,"MacAddress":"00:50:56:bd:9d:24"}],"TargetFolder":null,"StorageProfile":null,"JournalHardLimit":{"Type":0,"Limit":0},"JournalWarningThreshold":{"Type":0,"Limit":0},"JournalDatastores":[{"Id":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"DatastoreClusterIdentifier":null,"DisplayName":"ZNest81Datastore (73.7GB / 99.8GB Free)"}]},"Volume":{"SourceAddress":"[ZNest81Datastore]:Evgeny-vm1 - testing recovery(2)_2/Evgeny-vm1.vmdk","TargetAddress":"ZNest81Datastore (73.7GB / 99.8GB Free)","Swap":false,"ProvisionedSizeInMB":40,"InternalVolumeManagementSettings":{"DiskLocationParams":{"VMUuids":{"Uuid":"56 4d 46 53 d9 5f 28 c7-6a 60 19 66 6e d2 e6 a7","InstanceUuid":"52 df 64 4a b1 10 29 d1-8f 29 00 20 36 c1 7b 86"},"UnitNumber":0,"ControllerNumber":0,"VolumeType":0},"Settings":{"VolumeReplicationDestination":{"Datastore":{"IsThin":false,"TargetDatastore":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}}}}}},"IsSourceThinProvisioned":false},"Thin":false}],"enableBackupScripts":false,"sourceSiteType":{"sourceType":0},"vmsVCDNicsList":[],"selectedVcdVappVMs":[],"isEdit":false,"defaultTestNetwork":null,"defaultFailoverNetwork":null},"_vmsInInit":0}');

            controller = $controller('fileBrowseController', {
                $scope: scope,
                fileBrowseFactory: fileBrowseFactory,
                datastore: datastore,
                volume: volume,
                createVPGModel: createVPGModel
            });
        })
    )
    ;

    it("should have variables defined", function () {
        expect(scope.volume).toBeDefined();
        expect(scope.loading).toBeDefined();
        expect(scope.busy).toBeDefined();
        expect(scope.selectedNode).toBeDefined();
        expect(scope.data).toBeDefined();
        expect(scope.nodeIndex).toBeDefined();
        expect(scope.buttons).toBeDefined();
    });

    it("should have functions defined", function () {
        expect(scope.save).toBeDefined();
        expect(scope.close).toBeDefined();
        expect(scope._getIndex).toBeDefined();
        expect(scope._findNodeByName).toBeDefined();
        expect(scope._appendFiles).toBeDefined();
        expect(scope._appendFolders).toBeDefined();
        expect(scope._appendNodes).toBeDefined();
        expect(scope._browseWithPath).toBeDefined();
        expect(scope.select).toBeDefined();
        expect(scope.onRootBrowse).toBeDefined();
        expect(scope.onSubFolderBrowse).toBeDefined();
        expect(scope.onBrowseError).toBeDefined();
        expect(scope.focusOnElement).toBeDefined();
        expect(scope.selectNodeRecursive).toBeDefined();
        expect(scope.init).toBeDefined();
    });

    it('should send path when saved', function () {
        scope.path = 'testPath';
        scope.datastore = 'datastore';
        spyOn(fileBrowseFactory, 'save').and.callThrough();
        spyOn(scope, 'close').and.callThrough();
        scope.save();
        expect(fileBrowseFactory.save).toHaveBeenCalledWith('testPath','datastore');
        expect(scope.close).toHaveBeenCalled();
    });

    it('should call factory when closed', function () {
        spyOn(fileBrowseFactory, 'close').and.callThrough();
        scope.close();
        expect(fileBrowseFactory.close).toHaveBeenCalledWith('close');
    });

    it('should genereate node index', function () {
        expect(scope._getIndex()).toEqual(1);
        scope.nodeIndex = 100;
        expect(scope._getIndex()).toEqual(101);
    });

    it('should find a node in data by name', function () {
        var nodes = [
            {id: 1, name: 'test1'},
            {id: 2, name: 'test2'},
            {id: 3, name: 'test3'}
        ];

        expect(scope._findNodeByName(nodes, 'test2')).toEqual({id: 2, name: 'test2'});
    });

    it('should append files to node tree', function () {
        var target = {nodes: [], fullPath: ''};
        var data = {
            Files: [
                {FileName: 'test1', IsEnabled: false},
                {FileName: 'test2', IsEnabled: false},
                {FileName: 'test3', IsEnabled: true}
            ]
        };
        scope._appendFiles(target, data);
        expect(target.nodes).toEqual(
            [
                {
                    id: 'node1',
                    name: 'test1',
                    fullPath: '/test1',
                    nodes: [],
                    disabled: true,
                    isFile: true,
                    source: {FileName: 'test1', IsEnabled: false}
                },
                {
                    id: 'node2',
                    name: 'test2',
                    fullPath: '/test2',
                    nodes: [],
                    disabled: true,
                    isFile: true,
                    source: {FileName: 'test2', IsEnabled: false}
                },
                {
                    id: 'node3',
                    name: 'test3',
                    fullPath: '/test3',
                    nodes: [],
                    disabled: false,
                    isFile: true,
                    source: {FileName: 'test3', IsEnabled: true}
                }
            ]
        )
        ;
    });

    it('should append folders', function () {
        var target = {nodes: [], fullPath: ''};
        var data = {SubFolders: ['test1', 'test2']};
        scope._appendFolders(target, data);
        expect(target.nodes).toEqual([
            {
                id: 'node1',
                name: 'test1',
                fullPath: '/test1',
                nodes: [],
                disabled: false,
                isFile: false,
                collapsed: true
            },
            {id: 'node2', name: 'test2', fullPath: '/test2', nodes: [], disabled: false, isFile: false, collapsed: true}
        ]);
    });

    it('should append files and folders to target with data', function () {
        var target = {nodes: []};
        var data = {Files: [], SubFolders: []};
        spyOn(scope, '_appendFiles').and.callThrough();
        spyOn(scope, '_appendFolders').and.callThrough();
        scope._appendNodes(target, data);
        expect(scope._appendFiles).toHaveBeenCalledWith({nodes: []}, {Files: [], SubFolders: []});
        expect(scope._appendFolders).toHaveBeenCalledWith({nodes: []}, {Files: [], SubFolders: []});
    });

    it('should call proper functions in factory according to entity type', function () {
        scope._browseWithPath('test');

        expect(fileBrowseFactory.browseForVmdkFiles).toHaveBeenCalled();

        createVPGModel.data.defaultVpgSettings.Entities.Target = enums.VpgEntityType.VCDvApp;
        createVPGModel.data.targetOrgvDC =
        {
            VirtualDatacenter: {
                Id: {
                    VCDId: 'test'
                }
            }
        };
        scope._browseWithPath('test');

        expect(fileBrowseFactory.browseForVmdkFilesVcd).toHaveBeenCalled();
    });

    it('should return undefined when disabled node selected', function () {
        expect(scope.select({disabled: true})).toBeUndefined();
    });

    it('should run browse request when folder is selected', function () {
        spyOn(scope, '_browseWithPath').and.callThrough();
        scope.busy = true;
        scope.select({name: 'test', fullPath: '/', selected: false, isFile: false});

        expect(scope.path).toBeUndefined();
        expect(scope.busy).toBeFalsy();
        expect(scope._browseWithPath).toHaveBeenCalledWith('/');
    });

    it('should set path when file is selected', function () {
        spyOn(scope, '_browseWithPath').and.callThrough();
        scope.select({name: 'test', selected: false, isFile: true, source: {VmdkFullPath: 'testPath'}});
        expect(scope.path).toEqual('testPath');
    });

    it('should add root directories on init', function () {
        spyOn(scope, 'selectNodeRecursive');
        var result = JSON.parse('{"Files":[],"SubFolders":[".sdd.sf","GUI - Local VRA","liron vm1 - testing recovery","Yaniv Text VM","kobi vm 1(1)(1) - testing recovery","puptitz-test - testing recovery","kobi vm 1(1)(2)(4)","GUY-bigVM - testing recovery","puptitz-test","kobi vm 1(1)(2)","liron vm2 - testing recovery","Alex VM","kobi vm 1(1)(2)(1)","kobi vm 1(1)(2)(2)","kobi vm 1(1)(2)(3)","kobi vm 1(1)(2)(1)(1)","kobi vm 1(1)(2)(6)","GUI Local VRA","puptitz-test - testing recovery_1","kobi vm 1(1)(2)(1)(1) - testing recovery","kobi vm 1(1)(2) - testing recovery","GUI Team - ZeRTO volumes","alex vapp vm 1","kobi vm 1(1)(2)(5)","Evgeny-vm1 - testing recovery","Evgeny-vm1 - 2014-09-16_08-21-15","Evgeny-vm1 - 2014-09-16_08-25-55","Evgeny-vm1 - 2014-09-16_08-31-10","Evgeny-vm1 - 2014-09-16_08-41-40","Evgeny-vm1 - 2014-09-16_14-05-00","Evgeny-vm1 - testing recovery(1)","Evgeny-vm1 - testing recovery(2)","Alex VM - testing recovery","Alex VM - testing recovery(1)","Evgeny-vm1 - testing recovery(3)","Alex VM_1","Alex VM_2","Evgeny-vm1 - testing recovery(2)_1","Alex VM - testing recovery(2)","Evgeny-vm1 - testing recovery(2)_2","Evgeny-vm1 - testing recovery(3)_1","kobi vm 1(1)(2)_1","Alex VM - testing recovery(3)","Alex VM - testing recovery(1) - testing recovery"],"OriginalDiskSizeInBytes":41943040}');
        scope.onRootBrowse(result);
        expect(scope.selectNodeRecursive).toHaveBeenCalledWith(undefined, {
            id: 'root',
            name: '',
            nodes: [],
            isFile: false,
            fullPath: '',
            modified: true
        }, result, 0);
    });

    it('should call backend and append results when folder is clicked', function () {
        spyOn(scope, '_appendNodes');
        scope.selectedNode = scope.data[0];
        var result = JSON.parse('{"Files":[{"FileName":"Evgeny-vm1.vmdk","FileSizeInBytes":41943040,"IsEnabled":true,"Datastore":{"InternalDatastoreName":"datastore-12","ServerIdentifier":{"ServerGuid":"09d0d3b4-78d0-47c1-ad38-d01887e6d589"}},"VmdkFullPath":"Evgeny-vm1 - 2014-09-16_08-31-10/Evgeny-vm1.vmdk","DisabledReason":""}],"SubFolders":[],"OriginalDiskSizeInBytes":41943040}');
        scope.onSubFolderBrowse(result);
        expect(scope._appendNodes).toHaveBeenCalledWith({
            id: 'root',
            name: '',
            nodes: [],
            fullPath: '',
            isFile: false,
            modified: true
        }, result);
    });
});
